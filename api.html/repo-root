<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TransitCloud API — Developer Edition</title>
  <meta name="description" content="TransitCloud API blueprint: canonize, hash, sign, verify, bundle, anchor, and registry endpoints." />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="container topbar__inner">
      <a class="brand" href="./index.html">
        <span class="brand__mark" aria-hidden="true"></span>
        <span class="brand__name">TransitCloud</span>
        <span class="brand__tag">API</span>
      </a>

      <nav class="nav">
        <a href="./index.html">Home</a>
        <a href="./developers.html">Developers</a>
        <a class="is-active" href="./api.html">API</a>
        <a href="./verification.html">Verification</a>
        <a href="./registry.html">Registry</a>
        <a href="./enterprise.html">Enterprise</a>
      </nav>

      <div class="topbar__cta">
        <a class="btn btn--ghost" href="./transitcloud.openapi.json" target="_blank" rel="noopener">OpenAPI JSON</a>
        <button class="iconbtn" id="themeToggle" aria-label="Toggle theme" title="Toggle theme">◐</button>
      </div>
    </div>
  </header>

  <main>
    <section class="pageHead">
      <div class="container">
        <h1>TransitCloud API</h1>
        <p class="lead">
          Production-friendly endpoint design for canonicalization, hashing, signing, proof bundles, verification,
          optional onchain anchoring, and registry operations.
        </p>

        <div class="pillRow">
          <span class="pill">/v1/canonize</span>
          <span class="pill">/v1/hash</span>
          <span class="pill">/v1/sign</span>
          <span class="pill">/v1/verify</span>
          <span class="pill">/v1/bundle</span>
          <span class="pill">/v1/anchor</span>
          <span class="pill">/v1/registry/*</span>
        </div>
      </div>
    </section>

    <section class="section" id="base">
      <div class="container">
        <div class="grid2">
          <div class="card">
            <h3>Base URL</h3>
            <pre><code>Local:   http://localhost:8787
Prod:    https://api.documentcurrency.com</code></pre>
            <p>Keep v1 stable. Breaking changes ship as v2.</p>
          </div>

          <div class="card">
            <h3>Auth (recommended)</h3>
            <pre><code>Authorization: Bearer &lt;token&gt;</code></pre>
            <p>Use scoped tokens for pilots. Log every request with an audit id.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="section section--alt" id="endpoints">
      <div class="container">
        <div class="section__head">
          <h2>Core endpoints</h2>
          <p>Examples below are blueprint-friendly and can match your current JSON formats.</p>
        </div>

        <div class="apiGrid">
          <div class="card">
            <h3>POST /v1/canonize</h3>
            <p>Canonicalize DOC payload into stable bytes.</p>
            <pre><code>{
  "doc": { "type": "DOC.USD", "version": "v1", "body": {} },
  "ruleset": "canon.v1"
}</code></pre>
            <pre><code>{
  "canonical_b64": "base64(...)",
  "ruleset": "canon.v1",
  "byte_length": 1234
}</code></pre>
          </div>

          <div class="card">
            <h3>POST /v1/hash</h3>
            <p>Generate SHA-256 root from canonical bytes.</p>
            <pre><code>{
  "canonical_b64": "base64(...)"
}</code></pre>
            <pre><code>{
  "alg": "sha256",
  "root_hex": "e5fc9f81...dea90",
  "byte_length": 1234
}</code></pre>
          </div>

          <div class="card">
            <h3>POST /v1/sign</h3>
            <p>Sign canonical bytes (Ed25519). Server-side key reference.</p>
            <pre><code>{
  "canonical_b64": "base64(...)",
  "key_ref": "issuer-key-1"
}</code></pre>
            <pre><code>{
  "sig_b64": "base64(...)",
  "pubkey_b64": "base64(...)",
  "pubkey_fp": "ed25519:...fingerprint"
}</code></pre>
          </div>

          <div class="card">
            <h3>POST /v1/bundle</h3>
            <p>Create portable proof bundle JSON.</p>
            <pre><code>{
  "doc": {},
  "ruleset": "canon.v1",
  "root_hex": "…",
  "signatures": [ { "sig_b64": "...", "pubkey_fp": "..." } ]
}</code></pre>
            <pre><code>{
  "bundle": {},
  "bundle_sha256": "…"
}</code></pre>
          </div>

          <div class="card">
            <h3>POST /v1/verify</h3>
            <p>Verify bundle: canonicalize → hash → verify signatures → optional anchor checks.</p>
            <pre><code>{
  "bundle": { "doc": {}, "ruleset": "canon.v1", "root_hex": "…", "signatures": [] }
}</code></pre>
            <pre><code>{
  "ok": true,
  "checks": { "canonical": true, "root_hash": true, "signatures": true, "anchor": "skipped" },
  "errors": []
}</code></pre>
          </div>

          <div class="card">
            <h3>POST /v1/anchor (optional)</h3>
            <p>Anchor a root hash onchain (attestation-only; no content).</p>
            <pre><code>{
  "root_hex": "…",
  "network": "base",
  "mode": "attest"
}</code></pre>
            <pre><code>{
  "tx_hash": "0x…",
  "chain_id": 8453,
  "block": 123456,
  "status": "submitted"
}</code></pre>
          </div>
        </div>

        <div class="tip">
          <strong>Note:</strong> Anchoring publishes only hashes (no document content), keeping PII offchain while enabling timestamped proof-of-record.
        </div>
      </div>
    </section>

    <section class="section" id="registry">
      <div class="container">
        <div class="section__head">
          <h2>Registry endpoints (optional)</h2>
          <p>Use these if you want a custody/record index layer.</p>
        </div>

        <div class="apiGrid">
          <div class="card">
            <h3>POST /v1/registry/ingest</h3>
            <p>Register a proof bundle root + metadata.</p>
            <pre><code>{
  "root_hex": "…",
  "doc_type": "invoice",
  "issuer": { "id": "issuer-1", "pubkey_fp": "…" },
  "bundle_sha256": "…"
}</code></pre>
          </div>

          <div class="card">
            <h3>GET /v1/registry/roots/:root</h3>
            <p>Fetch registry record for a root hash.</p>
            <pre><code>{
  "root_hex": "…",
  "seen": true,
  "events": [ { "eventId": "…", "action": "INGEST", "ts": "…" } ]
}</code></pre>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="download">
      <div class="container">
        <div class="callout">
          <div class="callout__copy">
            <h2>OpenAPI spec</h2>
            <p>Use the spec file for tooling, documentation, and future SDK generation.</p>
          </div>
          <div class="callout__cta">
            <a class="btn btn--primary" href="./transitcloud.openapi.json" target="_blank" rel="noopener">OpenAPI JSON</a>
            <a class="btn btn--ghost" href="./developers.html#recipes">Verification recipes</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer__grid">
      <div>
        <div class="footer__brand">TransitCloud</div>
        <div class="footer__sub">API Blueprint — Developer Edition</div>
      </div>
      <div class="footer__links">
        <a href="./developers.html">Developers</a>
        <a href="./index.html">Home</a>
      </div>
      <div class="footer__meta">
        <div>© <span id="year"></span> Kam Swygert</div>
      </div>
    </div>
  </footer>

  <script src="./app.js"></script>
</body>
</html>        <h1>TransitCloud API</h1>
        <p class="lead">
          Production-friendly endpoint design for canonization, hashing, signing, proof bundles, and optional onchain anchoring.
          This is a developer edition blueprint and can be implemented as a local service, an internal gateway, or a public API.
        </p>

        <div class="pillRow">
          <span class="pill">/v1/canonize</span>
          <span class="pill">/v1/hash</span>
          <span class="pill">/v1/sign</span>
          <span class="pill">/v1/verify</span>
          <span class="pill">/v1/bundle</span>
          <span class="pill">/v1/anchor</span>
        </div>
      </div>
    </section>

    <section class="section" id="base">
      <div class="container">
        <div class="grid2">
          <div class="card">
            <h3>Base URL</h3>
            <pre><code>Local:   http://localhost:8787
Prod:    https://api.documentcurrency.com</code></pre>
            <p>Keep v1 stable. Version breaking changes by creating v2, not by changing v1 behavior.</p>
          </div>

          <div class="card">
            <h3>Auth (recommended)</h3>
            <pre><code>Authorization: Bearer &lt;token&gt;</code></pre>
            <p>For pilots, use API tokens scoped by org + environment. Log all requests with an audit id.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="section section--alt" id="endpoints">
      <div class="container">
        <div class="section__head">
          <h2>Endpoints</h2>
          <p>Request/response examples. Adjust field names to match Kam’s canonical schema.</p>
        </div>

        <div class="apiGrid">
          <div class="card">
            <h3>POST /v1/canonize</h3>
            <p>Canonicalize DOC payload into stable bytes.</p>
            <pre><code>{
  "doc": { "type": "DOC.USD", "version": "v1", "body": { } },
  "ruleset": "canon.v1"
}</code></pre>
            <pre><code>{
  "canonical_b64": "base64(...)",
  "ruleset": "canon.v1",
  "byte_length": 1234
}</code></pre>
          </div>

          <div class="card">
            <h3>POST /v1/hash</h3>
            <p>Generate SHA-256 from canonical bytes.</p>
            <pre><code>{
  "canonical_b64": "base64(...)"
}</code></pre>
            <pre><code>{
  "alg": "sha256",
  "root_hex": "e5fc9f81...dea90",
  "byte_length": 1234
}</code></pre>
          </div>

          <div class="card">
            <h3>POST /v1/sign</h3>
            <p>Sign canonical bytes using Ed25519 (server-side key ref).</p>
            <pre><code>{
  "canonical_b64": "base64(...)",
  "key_ref": "issuer-key-1"
}</code></pre>
            <pre><code>{
  "sig_b64": "base64(...)",
  "pubkey_b64": "base64(...)",
  "pubkey_fp": "ed25519:...fingerprint"
}</code></pre>
          </div>

          <div class="card">
            <h3>POST /v1/verify</h3>
            <p>Verify full proof bundle.</p>
            <pre><code>{
  "bundle": {
    "doc": {},
    "ruleset": "canon.v1",
    "root_hex": "…",
    "signatures": []
  }
}</code></pre>
            <pre><code>{
  "ok": true,
  "checks": {
    "canonical": true,
    "root_hash": true,
    "signatures": true,
    "anchor": "skipped"
  },
  "errors": []
}</code></pre>
          </div>

          <div class="card">
            <h3>POST /v1/bundle</h3>
            <p>Create portable proof bundle JSON.</p>
            <pre><code>{
  "doc": {},
  "ruleset": "canon.v1",
  "signatures": [ { "sig_b64": "...", "pubkey_fp": "..." } ]
}</code></pre>
            <pre><code>{
  "bundle": { },
  "bundle_sha256": "…"
}</code></pre>
          </div>

          <div class="card">
            <h3>POST /v1/anchor (optional)</h3>
            <p>Anchor a root hash on an EVM chain (attestation only).</p>
            <pre><code>{
  "root_hex": "…",
  "network": "base",
  "mode": "attest"
}</code></pre>
            <pre><code>{
  "tx_hash": "0x…",
  "chain_id": 8453,
  "block": 123456,
  "status": "submitted"
}</code></pre>
          </div>
        </div>

        <div class="tip">
          <strong>Regulatory-friendly note:</strong> Anchoring publishes only hashes (no document content), preserving privacy while enabling timestamped proof-of-record.
        </div>
      </div>
    </section>

    <section class="section" id="downloads">
      <div class="container">
        <div class="callout">
          <div class="callout__copy">
            <h2>Download</h2>
            <p>Use the OpenAPI file for tooling and client generation.</p>
          </div>
          <div class="callout__cta">
            <a class="btn btn--primary" href="./transitcloud.openapi.json" target="_blank" rel="noopener">OpenAPI JSON</a>
            <a class="btn btn--ghost" href="./developers.html#recipes">Verification recipes</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer__grid">
      <div>
        <div class="footer__brand">TransitCloud</div>
        <div class="footer__sub">API Blueprint — Developer Edition</div>
      </div>
      <div class="footer__links">
        <a href="./developers.html">Developers</a>
        <a href="./docs.html">Docs</a>
      </div>
      <div class="footer__meta">
        <div>© <span id="year"></span> Kam Swygert</div>
      </div>
    </div>
  </footer>

  <script src="./app.js"></script>
</body>
</html>
